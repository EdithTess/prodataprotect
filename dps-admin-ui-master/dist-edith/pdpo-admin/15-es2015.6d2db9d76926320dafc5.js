(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"6BeY":function(t,e,i){"use strict";i.d(e,"a",function(){return g});var a=i("ofXK"),n=i("YUcS"),o=i("3Pt+"),s=i("bTqV"),r=i("0IaG"),c=i("NFeN"),l=i("qFsG"),b=i("QibW"),u=i("d3UM"),m=i("fXoL");let g=(()=>{class t{}return t.\u0275mod=m.Mb({type:t}),t.\u0275inj=m.Lb({factory:function(e){return new(e||t)},imports:[[a.c,o.i,o.s,n.a,r.f,l.c,s.b,c.b,b.c,u.b]]}),t})()},"8JRu":function(t,e,i){"use strict";i.r(e),i.d(e,"InvestigationsModule",function(){return ee});var a=i("ofXK"),n=i("tyNb"),o=i("fXoL"),s=i("0/vc"),r=i("pbD1"),c=i("+0xr"),l=i("M9IT"),b=i("Dh3D"),u=i("jtHE"),m=i("3eU1"),g=i("j7tn"),d=i("3fLY"),p=i("WVpI"),h=i("AytR"),f=i("aTx8"),v=i("tk/3");let T=(()=>{class t extends p.a{constructor(t,e){super(),this.auth=t,this.http=e,this.baseAPIUri=h.a.backend,this.httpUtils=new d.a(t,e)}getInvestigations(t,e,i){return this.httpUtils.invokeGet(this.baseAPIUri+"v1.0/investigations",t,e,i,this.handleError)}getInvestigation(t,e,i,a){return this.httpUtils.invokeGet(this.baseAPIUri+"v1.0/investigations/single?InvestigationTrackingNo="+t,e,i,a,this.handleError)}updateInvestigationStatus(t,e,i){}}return t.\u0275fac=function(e){return new(e||t)(o.Yb(f.c),o.Yb(v.c))},t.\u0275prov=o.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var C=i("2nsv"),U=(i("6xCn"),i("0IaG")),I=i("xBcV"),R=i("Hbgg"),x=i("rnAf"),y=i("rvYj"),k=i("a+RD"),P=i("bSwM"),w=i("bTqV"),O=i("STbY"),D=i("NFeN");const N=["autosize"];function S(t,e){1&t&&(o.Ub(0,"th",13),o.Ub(1,"mat-checkbox",14),o.cc("click",function(t){return t.stopPropagation()}),o.Tb(),o.Tb())}function F(t,e){1&t&&(o.Ub(0,"td",15),o.Ub(1,"mat-checkbox",14),o.cc("click",function(t){return t.stopPropagation()}),o.Tb(),o.Tb())}function A(t,e){if(1&t&&(o.Ub(0,"th",20),o.Rc(1),o.Tb()),2&t){const t=o.gc(2).$implicit;o.Cb(1),o.Tc(" ",t.name,"")}}function M(t,e){if(1&t&&(o.Ub(0,"td",21),o.Rc(1),o.Tb()),2&t){const t=e.$implicit,i=o.gc(2).$implicit;o.Cb(1),o.Tc(" ",t[i.property]," ")}}function E(t,e){if(1&t&&(o.Sb(0,17),o.Pc(1,A,2,1,"th",18),o.Pc(2,M,2,1,"td",19),o.Rb()),2&t){const t=o.gc().$implicit;o.nc("matColumnDef",t.property)}}function z(t,e){if(1&t&&(o.Sb(0),o.Pc(1,E,3,1,"ng-container",16),o.Rb()),2&t){const t=e.$implicit;o.Cb(1),o.nc("ngIf",t.isModelProperty)}}function L(t,e){1&t&&o.Pb(0,"th",22)}function j(t,e){if(1&t){const t=o.Vb();o.Ub(0,"td",15),o.Ub(1,"button",23),o.cc("click",function(t){return t.stopPropagation()}),o.Ub(2,"mat-icon"),o.Rc(3,"more_vert"),o.Tb(),o.Tb(),o.Ub(4,"mat-menu",24,25),o.Ub(6,"button",26),o.cc("click",function(){o.Ec(t);const i=e.$implicit;return o.gc().manageInvestigation(i)}),o.Ub(7,"mat-icon"),o.Rc(8,"settings"),o.Tb(),o.Ub(9,"span"),o.Rc(10,"Manage"),o.Tb(),o.Tb(),o.Tb(),o.Tb()}if(2&t){const t=o.Ac(5);o.Cb(1),o.nc("matMenuTriggerFor",t)}}function q(t,e){1&t&&o.Pb(0,"tr",27)}function G(t,e){1&t&&o.Pb(0,"tr",28)}const _=function(){return["Investigations"]};let V=(()=>{class t{constructor(t,e,i,a,n,s,r){this.dialog=t,this.route=e,this.authService=i,this.router=a,this._workflowService=n,this.registrationService=s,this.investigationService=r,this.subject$=new u.a(1),this.data$=this.subject$.asObservable(),this.$processingEvent=new o.o,this.$errorsEvent=new o.o,this.$resultInvestigationsEvent=new o.o,this.statusList=[],this.subscriptions=[],this.workflowID="1",this.columns=[{name:"Investigation ID",property:"InvestigationID",isModelProperty:!0,visible:!1},{name:"Investigation Tracking Number",property:"InvestigationTrackingNo",visible:!0,isModelProperty:!0},{name:"Organisation",property:"Organisation",visible:!0,isModelProperty:!0},{name:"Type of Investigation",property:"InvestigationType",visible:!0,isModelProperty:!0},{name:"Investigation Status",property:"InvestigationStatus",visible:!0,isModelProperty:!0},{name:"Actions",property:"actions",visible:!0}],this.pageSize=10}get visibleColumns(){return this.columns.filter(t=>t.visible).map(t=>t.property)}ngOnInit(){this.dataSource=new c.o,console.log("here"),this.getInvestigations(),console.log(this.getInvestigations),this.subscriptions.$resultInvestigationsEvent=this.$resultInvestigationsEvent.subscribe(t=>{t?(this.investigations=t,this.dataSource.data=t):console.log("expected")}),this.route.paramMap.subscribe(t=>{console.log(t.has("navigationPrams"))}),this.defineSearchFields()}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}onFilterChange(t){this.dataSource&&(t=(t=t.trim()).toLowerCase(),this.dataSource.filter=t)}ngOnDestroy(){}defineSearchFields(){this.searchFields=[{label:"Complaint reference #",fieldName:"complaintReference",operators:r.e,dataType:r.a.TEXT},{label:"Data subject",fieldName:"subjectNames",operators:r.e,dataType:r.a.TEXT},{label:"Form Types",fieldName:"Form",operators:r.d,dataType:r.a.TEXT,lookupOptions:this.statusList,multiple:!0},{label:"Reason for the complaint",fieldName:"type",operators:r.e,dataType:r.a.TEXT},{label:"Filed Against",fieldName:"compliantAgainst",operators:r.e,dataType:r.a.TEXT},{label:"Registration date",fieldName:"registrationDate",operators:r.c,dataType:r.a.DATETIME}]}getInvestigations(){this.investigationService.getInvestigations(this.$processingEvent,this.$resultInvestigationsEvent,this.$errorsEvent)}viewInvestigation(t){this.router.navigate(["/investigations/view-investigation"],{state:{InvestigationTrackingNumber:t.InvestigationTrackingNo}}).then()}manageInvestigation(t){this.router.navigate(["/investigations/investigations-edit"],{state:{InvestigationTrackingNumber:t.InvestigationTrackingNo,InvestigationID:t.InvestigationID}}).then()}viewApplicationTimeLine(){this.dialog.open(C.a,{width:"941px",height:"595px",data:this.workflowTimeLine})}}return t.\u0275fac=function(e){return new(e||t)(o.Ob(U.b),o.Ob(n.a),o.Ob(f.c),o.Ob(n.f),o.Ob(m.a),o.Ob(g.a),o.Ob(T))},t.\u0275cmp=o.Ib({type:t,selectors:[["fury-investigations-find"]],viewQuery:function(t,e){if(1&t&&(o.Kc(l.a,!0),o.Kc(b.a,!0),o.Vc(N,!0)),2&t){let t;o.zc(t=o.dc())&&(e.paginator=t.first),o.zc(t=o.dc())&&(e.sort=t.first),o.zc(t=o.dc())&&(e.autosize=t.first)}},inputs:{columns:"columns"},decls:16,vars:11,consts:[["mode","card"],["current","Find",3,"crumbs"],["name","Investigations","finderDialogTitle","Investigations Finder",3,"columns","searchFields","filterChange"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","checkbox"],["class","actions-cell","mat-header-cell","",4,"matHeaderCellDef"],["class","actions-cell","mat-cell","",4,"matCellDef"],[4,"ngFor","ngForOf"],["matColumnDef","actions"],["class","actions-cell","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","clickable route-animations-elements","mat-row","",4,"matRowDef","matRowDefColumns"],[1,"paginator",3,"pageSize"],["mat-header-cell","",1,"actions-cell"],["color","primary",3,"click"],["mat-cell","",1,"actions-cell"],[3,"matColumnDef",4,"ngIf"],[3,"matColumnDef"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell","","mat-sort-header","",1,"actions-cell"],["type","button","mat-icon-button","",3,"matMenuTriggerFor","click"],["yPosition","below","xPosition","before"],["actionsMenu","matMenu"],["mat-menu-item","","routerLinkActive","router-link-active",3,"click"],["mat-header-row",""],["mat-row","",1,"clickable","route-animations-elements"]],template:function(t,e){1&t&&(o.Ub(0,"fury-page-layout",0),o.Ub(1,"fury-page-layout-header"),o.Pb(2,"fury-breadcrumbs",1),o.Tb(),o.Ub(3,"fury-page-layout-content"),o.Ub(4,"fury-list",2),o.cc("filterChange",function(t){return e.onFilterChange(t)}),o.Ub(5,"table",3),o.Sb(6,4),o.Pc(7,S,2,0,"th",5),o.Pc(8,F,2,0,"td",6),o.Rb(),o.Pc(9,z,2,1,"ng-container",7),o.Sb(10,8),o.Pc(11,L,1,0,"th",9),o.Pc(12,j,11,1,"td",6),o.Rb(),o.Pc(13,q,1,0,"tr",10),o.Pc(14,G,1,0,"tr",11),o.Tb(),o.Pb(15,"mat-paginator",12),o.Tb(),o.Tb(),o.Tb()),2&t&&(o.Cb(2),o.nc("@fadeInRight",void 0)("crumbs",o.qc(10,_)),o.Cb(1),o.nc("@fadeInUp",void 0),o.Cb(1),o.nc("columns",e.columns)("searchFields",e.searchFields),o.Cb(1),o.nc("dataSource",e.dataSource),o.Cb(4),o.nc("ngForOf",e.columns),o.Cb(4),o.nc("matHeaderRowDef",e.visibleColumns),o.Cb(1),o.nc("matRowDefColumns",e.visibleColumns),o.Cb(1),o.nc("pageSize",e.pageSize))},directives:[I.a,R.a,x.a,y.a,k.a,c.n,b.a,c.c,c.i,c.b,a.n,c.k,c.m,l.a,c.h,P.a,c.a,a.o,b.b,w.a,O.e,D.a,O.a,O.c,n.h,c.j,c.l],styles:[""]}),t})();var $=i("sF9m"),B=i("3Pt+"),X=i("M2Gj"),H=i("LRne"),Y=i("r9HN"),K=(i("+eXY"),i("7R0Y")),Q=i("JIr8"),W=i("H+bZ"),J=(i("CKU1"),i("YStQ")),Z=i("UjNt"),tt=i("XiUz"),et=i("kmnG"),it=i("qFsG"),at=i("ihCf"),nt=i("znSr"),ot=i("Qu3c");function st(t,e){if(1&t){const t=o.Vb();o.Ub(0,"button",13),o.cc("click",function(){return o.Ec(t),o.gc().onRemoveDocument()}),o.Ub(1,"div",9),o.Ub(2,"mat-icon"),o.Rc(3,"clear"),o.Tb(),o.Ub(4,"span"),o.Rc(5," Remove Document "),o.Tb(),o.Tb(),o.Tb()}}function rt(t,e){if(1&t){const t=o.Vb();o.Ub(0,"div",14),o.cc("click",function(){o.Ec(t);const e=o.gc();return e.onReadDocument(e.evidenceDocument)}),o.Pb(1,"img",15),o.Ub(2,"span"),o.Rc(3),o.Ub(4,"span"),o.Rc(5),o.Tb(),o.Tb(),o.Tb()}if(2&t){const t=o.gc();o.Cb(3),o.Tc("",null==t.evidenceDocument?null:t.evidenceDocument.Name," "),o.Cb(2),o.Tc(" - ",null==t.evidenceDocument?null:t.evidenceDocument.Size," Mbs")}}const ct=function(){return{"margin-bottom":"20px","margin-top":"20px","background-color":"#ABC334",color:"#000"}};let lt=(()=>{class t{constructor(t,e,i,a,n,s,r,c){this.fb=t,this.endpoints=e,this.http=i,this.service=a,this.dialog=n,this.route=s,this.allDialogRef=r,this.parent_data=c,this.InvestigationCommentsFormGroup=this.fb.group({Comments:["",B.u.compose([B.u.required])]}),this.$processingEvent=new o.o,this.$errorsEvent=new o.o,this.processing=!1}ngOnInit(){}onUploadAttachments(){this.dialogRef=this.dialog.open(Z.a,{panelClass:["resolution-upload-dialog","dialogs"],disableClose:!0,data:{multiple:!1,maxSize:3}}),this.dialogRef.afterClosed().subscribe(t=>{t.status&&(this.evidenceDocument=t.row,console.log(this.evidenceDocument))})}getFormData(){return{ClosingRemarks:this.InvestigationCommentsFormGroup.get("Comments").value,InvestigationTrackingNo:this.parent_data.InvestigationTrackingNumber,InvestigationStatus:this.parent_data.Status,User:this.parent_data.ClosingRemarksOwner,EvidenceFile:""}}onSubmit(){this.processing=!0,console.log("Comments:",this.getFormData()),this.httpSub=this.http.post(this.endpoints.updateInvestigationStatus,this.getFormData()).pipe(Object(Q.a)(this.service.handleError)).subscribe(t=>{this.dialogRef=this.dialog.open(J.a,{panelClass:["successful-message-dialog","dialogs"],disableClose:!0,data:{title:"Update Complaint Status",message:t.message,status:200===t.code}}),this.dialogRef.afterClosed().subscribe(()=>{this.allDialogRef.closeAll(),this.route.navigate(["/complaints/find"])}),this.processing=!1},t=>{this.processing=!1,t.error.message?this.dialogRef=this.dialog.open(J.a,{panelClass:["successful-message-dialog","dialogs"],disableClose:!0,data:{title:t.error.message.title?t.error.message.title:"Operation Failed",message:t.error.message.body?t.error.message.body:h.a.technicalErrorResponse,status:!1}}):this.service.determineErrorResponse(t)})}}return t.\u0275fac=function(e){return new(e||t)(o.Ob(B.d),o.Ob(K.a),o.Ob(v.c),o.Ob(W.a),o.Ob(U.b),o.Ob(n.f),o.Ob(U.b),o.Ob(U.a))},t.\u0275cmp=o.Ib({type:t,selectors:[["fury-investigation-comments"]],decls:25,vars:6,consts:[[2,"padding","10px"],["mat-dialog-title",""],[3,"formGroup"],["fxLayout","column","fxLayoutGap","8px",1,"content"],["fxLayout","column","fxLayout.gt-xs","row","fxLayoutGap","8px","fxLayoutGap.gt-xs","24px"],["fxFlex","2 2 auto","appearance","fill"],["matInput","","cdkTextareaAutosize","","cdkAutosizeMinRows","6","formControlName","Comments","cdkAutosizeMaxRows","10","formControlName","Comments"],[1,"buttons"],["mat-button","","color","primary",1,"add-item-button",3,"ngStyle","click"],[1,"button-label"],["mat-button","","color","primary","class","remove-button",3,"click",4,"ngIf"],["class","uploaded-document","matTooltip","Open Document",3,"click",4,"ngIf"],["mat-raised-button","","color","primary",3,"click"],["mat-button","","color","primary",1,"remove-button",3,"click"],["matTooltip","Open Document",1,"uploaded-document",3,"click"],["src","./assets/images/pdf.png","alt",""]],template:function(t,e){1&t&&(o.Ub(0,"div",0),o.Ub(1,"div",1),o.Rc(2,"Make Comments"),o.Tb(),o.Ub(3,"form",2),o.Ub(4,"mat-dialog-content"),o.Ub(5,"div",3),o.Ub(6,"div",4),o.Ub(7,"mat-form-field",5),o.Ub(8,"mat-label"),o.Rc(9,"Provide Comments"),o.Tb(),o.Pb(10,"textarea",6),o.Ub(11,"mat-hint"),o.Rc(12,"Review Comments"),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Ub(13,"section"),o.Ub(14,"div",7),o.Ub(15,"button",8),o.cc("click",function(){return e.onUploadAttachments()}),o.Ub(16,"div",9),o.Ub(17,"span"),o.Rc(18),o.Tb(),o.Tb(),o.Tb(),o.Pc(19,st,6,0,"button",10),o.Tb(),o.Pc(20,rt,6,2,"div",11),o.Tb(),o.Ub(21,"button",12),o.cc("click",function(){return e.onSubmit()}),o.Ub(22,"span"),o.Rc(23,"Submit"),o.Tb(),o.Tb(),o.Rc(24,"\xa0 "),o.Tb(),o.Tb()),2&t&&(o.Cb(3),o.nc("formGroup",e.InvestigationCommentsFormGroup),o.Cb(12),o.nc("ngStyle",o.qc(5,ct)),o.Cb(3),o.Tc(" ",e.evidenceDocument?"Replace Document":"Upload A Document"," "),o.Cb(1),o.nc("ngIf",null==e.evidenceDocument?null:e.evidenceDocument.Name),o.Cb(1),o.nc("ngIf",null==e.evidenceDocument?null:e.evidenceDocument.Base64))},directives:[U.h,B.v,B.o,B.h,U.e,tt.d,tt.e,et.d,tt.b,et.h,it.b,at.b,B.c,B.n,B.g,et.g,w.a,a.p,nt.c,a.o,D.a,ot.a],styles:[""]}),t})();var bt=i("zqeb"),ut=i("aViL"),mt=i("aYi0");function gt(t,e){if(1&t){const t=o.Vb();o.Ub(0,"button",13),o.cc("click",function(){return o.Ec(t),o.gc().onRemoveDocument()}),o.Ub(1,"div",9),o.Ub(2,"mat-icon"),o.Rc(3,"clear"),o.Tb(),o.Ub(4,"span"),o.Rc(5," Remove Document "),o.Tb(),o.Tb(),o.Tb()}}function dt(t,e){if(1&t){const t=o.Vb();o.Ub(0,"div",14),o.cc("click",function(){o.Ec(t);const e=o.gc();return e.onReadDocument(e.evidenceDocument)}),o.Pb(1,"img",15),o.Ub(2,"span"),o.Rc(3),o.Ub(4,"span"),o.Rc(5),o.Tb(),o.Tb(),o.Tb()}if(2&t){const t=o.gc();o.Cb(3),o.Tc("",null==t.evidenceDocument?null:t.evidenceDocument.Name," "),o.Cb(2),o.Tc(" - ",null==t.evidenceDocument?null:t.evidenceDocument.Size," Mbs")}}const pt=function(){return{"margin-bottom":"20px","margin-top":"20px","background-color":"#ABC334",color:"#000"}};let ht=(()=>{class t{constructor(t,e,i,a,n,s,r,c){this.fb=t,this.endpoints=e,this.http=i,this.service=a,this.dialog=n,this.route=s,this.allDialogRef=r,this.parent_data=c,this.InvestigationCommentsFormGroup=this.fb.group({}),this.$processingEvent=new o.o,this.$errorsEvent=new o.o,this.$resultComplaintsEvent=new o.o,this.processing=!1}ngOnInit(){this.InvestigationCommentsFormGroup=this.fb.group({Comments:new B.e("",[B.u.required])}),console.log(this.parent_data)}getFormData(){return{Notes:this.InvestigationCommentsFormGroup.get("Comments").value,InvestigationTrackingNo:this.parent_data.InvestigationTrackingNumber,InvestigationStatus:this.parent_data.Status,InvestigationEvidenceFile:"",RequestInformation:0,RequestInformtationQuery:"",EvidenceOwner:this.parent_data.EvidenceOwner}}onSubmit(){this.processing=!0,console.log("Comments:",this.getFormData()),this.httpSub=this.http.post(this.endpoints.makeInvestigationNotes,this.getFormData()).pipe(Object(Q.a)(this.service.handleError)).subscribe(t=>{this.dialogRef=this.dialog.open(J.a,{panelClass:["successful-message-dialog","dialogs"],disableClose:!0,data:{title:"Make Investigation Notes",message:t.message,status:200===t.code}}),this.dialogRef.afterClosed().subscribe(()=>{this.allDialogRef.closeAll(),this.route.navigate(["/investigations/find"])}),this.processing=!1},t=>{this.processing=!1,t.error.message?this.dialogRef=this.dialog.open(J.a,{panelClass:["successful-message-dialog","dialogs"],disableClose:!0,data:{title:t.error.message.title?t.error.message.title:"Operation Failed",message:t.error.message.body?t.error.message.body:h.a.technicalErrorResponse,status:!1}}):this.service.determineErrorResponse(t)})}onUploadAttachments(){this.dialogRef=this.dialog.open(Z.a,{panelClass:["resolution-upload-dialog","dialogs"],disableClose:!0,data:{multiple:!1,maxSize:3}}),this.dialogRef.afterClosed().subscribe(t=>{t.status&&(this.evidenceDocument=t.row,console.log(this.evidenceDocument))})}}return t.\u0275fac=function(e){return new(e||t)(o.Ob(B.d),o.Ob(K.a),o.Ob(v.c),o.Ob(W.a),o.Ob(U.b),o.Ob(n.f),o.Ob(U.b),o.Ob(U.a))},t.\u0275cmp=o.Ib({type:t,selectors:[["fury-investigation-notes"]],decls:25,vars:6,consts:[[2,"padding","10px"],["mat-dialog-title",""],[3,"formGroup"],["fxLayout","column","fxLayoutGap","8px",1,"content"],["fxLayout","column","fxLayout.gt-xs","row","fxLayoutGap","8px","fxLayoutGap.gt-xs","24px"],["fxFlex","2 2 auto","appearance","fill"],["matInput","","cdkTextareaAutosize","","cdkAutosizeMinRows","6","formControlName","comments","cdkAutosizeMaxRows","10","formControlName","Comments"],[1,"buttons"],["mat-button","","color","primary",1,"add-item-button",3,"ngStyle","click"],[1,"button-label"],["mat-button","","color","primary","class","remove-button",3,"click",4,"ngIf"],["class","uploaded-document","matTooltip","Open Document",3,"click",4,"ngIf"],["mat-raised-button","","color","primary",3,"click"],["mat-button","","color","primary",1,"remove-button",3,"click"],["matTooltip","Open Document",1,"uploaded-document",3,"click"],["src","./assets/images/pdf.png","alt",""]],template:function(t,e){1&t&&(o.Ub(0,"div",0),o.Ub(1,"div",1),o.Rc(2,"Make Investigation Notes"),o.Tb(),o.Ub(3,"form",2),o.Ub(4,"mat-dialog-content"),o.Ub(5,"div",3),o.Ub(6,"div",4),o.Ub(7,"mat-form-field",5),o.Ub(8,"mat-label"),o.Rc(9,"Provide Notes"),o.Tb(),o.Pb(10,"textarea",6),o.Ub(11,"mat-hint"),o.Rc(12,"Review Notes"),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Ub(13,"section"),o.Ub(14,"div",7),o.Ub(15,"button",8),o.cc("click",function(){return e.onUploadAttachments()}),o.Ub(16,"div",9),o.Ub(17,"span"),o.Rc(18),o.Tb(),o.Tb(),o.Tb(),o.Pc(19,gt,6,0,"button",10),o.Tb(),o.Pc(20,dt,6,2,"div",11),o.Tb(),o.Ub(21,"button",12),o.cc("click",function(){return e.onSubmit()}),o.Ub(22,"span"),o.Rc(23,"Submit"),o.Tb(),o.Tb(),o.Rc(24,"\xa0 "),o.Tb(),o.Tb()),2&t&&(o.Cb(3),o.nc("formGroup",e.InvestigationCommentsFormGroup),o.Cb(12),o.nc("ngStyle",o.qc(5,pt)),o.Cb(3),o.Tc(" ",e.evidenceDocument?"Replace Document":"Upload A Document"," "),o.Cb(1),o.nc("ngIf",null==e.evidenceDocument?null:e.evidenceDocument.Name),o.Cb(1),o.nc("ngIf",null==e.evidenceDocument?null:e.evidenceDocument.Base64))},directives:[U.h,B.v,B.o,B.h,U.e,tt.d,tt.e,et.d,tt.b,et.h,it.b,at.b,B.c,B.n,B.g,et.g,w.a,a.p,nt.c,a.o,D.a,ot.a],styles:[""]}),t})();const ft=function(){return{"text-align":"center"}};let vt=(()=>{class t{constructor(t,e,i,a,n,o,s,r){this.fb=t,this.endpoints=e,this.http=i,this.service=a,this.dialog=n,this.route=o,this.allDialogRef=s,this.parent_data=r,this.processing=!1,this.InvestigationCommentsFormGroup=this.fb.group({})}ngOnInit(){this.InvestigationCommentsFormGroup=this.fb.group({Comments:new B.e("",[B.u.required]),InvestigationForwardedComments:new B.e("")}),this.InvestigationCommentsFormGroup.get("InvestigationForwardedComments").setValue(this.parent_data.TechnicalComments)}getInvestigationData(){return{InvestigationTrackingNo:this.parent_data.InvestigationTrackingNumber,InvestigationStatus:this.parent_data.Status,User:this.parent_data.User,ClosingRemarks:"",ClosingRemarksOwner:this.parent_data.User}}onSubmit(){(this.processing=!0)&&(console.log("Comments:",this.getInvestigationData()),this.httpSub=this.http.post(this.endpoints.updateInvestigationStatus,this.getInvestigationData()).pipe(Object(Q.a)(this.service.handleError)).subscribe(t=>{this.dialogRef=this.dialog.open(J.a,{panelClass:["successful-message-dialog","dialogs"],disableClose:!0,data:{title:"Update Investigation Status",message:"Investigation forwarded successfully",status:200===t.code}}),this.dialogRef.afterClosed().subscribe(()=>{this.allDialogRef.closeAll(),this.route.navigate(["/investigations/find"])}),this.processing=!1},t=>{this.processing=!1,t.error.message?this.dialogRef=this.dialog.open(J.a,{panelClass:["successful-message-dialog","dialogs"],disableClose:!0,data:{title:t.error.message.title?t.error.message.title:"Operation Failed",message:t.error.message.body?t.error.message.body:h.a.technicalErrorResponse,status:!1}}):this.service.determineErrorResponse(t)}))}onCancel(){this.dialogRef.afterClosed().subscribe(()=>{this.allDialogRef.closeAll(),this.route.navigate(["/investigations/manage"])})}}return t.\u0275fac=function(e){return new(e||t)(o.Ob(B.d),o.Ob(K.a),o.Ob(v.c),o.Ob(W.a),o.Ob(U.b),o.Ob(n.f),o.Ob(U.b),o.Ob(U.a))},t.\u0275cmp=o.Ib({type:t,selectors:[["fury-forward-investigations"]],decls:15,vars:5,consts:[[3,"formGroup"],["fxLayout","column","fxLayoutGap","8px",1,"content",3,"ngStyle"],[3,"ngStyle"],["mat-raised-button","","color","primary",3,"click"]],template:function(t,e){1&t&&(o.Ub(0,"div"),o.Ub(1,"form",0),o.Ub(2,"mat-dialog-content"),o.Ub(3,"div",1),o.Ub(4,"p"),o.Rc(5,"Are you sure you want to forward?"),o.Tb(),o.Tb(),o.Tb(),o.Ub(6,"div",2),o.Ub(7,"button",3),o.cc("click",function(){return e.onCancel()}),o.Ub(8,"span"),o.Rc(9,"Cancel"),o.Tb(),o.Tb(),o.Rc(10,"\xa0 "),o.Ub(11,"button",3),o.cc("click",function(){return e.onSubmit()}),o.Ub(12,"span"),o.Rc(13,"Confirm"),o.Tb(),o.Tb(),o.Rc(14,"\xa0 "),o.Tb(),o.Tb(),o.Tb()),2&t&&(o.Cb(1),o.nc("formGroup",e.InvestigationCommentsFormGroup),o.Cb(2),o.nc("ngStyle",o.qc(3,ft)),o.Cb(3),o.nc("ngStyle",o.qc(4,ft)))},directives:[B.v,B.o,B.h,U.e,tt.d,tt.e,a.p,nt.c,w.a],styles:[""]}),t})();var Tt=i("9Ku7");let Ct=(()=>{class t{constructor(t,e,i,a,n,o,s,r){this.fb=t,this.endpoints=e,this.http=i,this.service=a,this.dialog=n,this.route=o,this.allDialogRef=s,this.parent_data=r,this.processing=!1,this.InvestigationFormGroup=this.fb.group({})}ngOnInit(){this.InvestigationFormGroup=this.fb.group({Comments:new B.e("",[B.u.required]),Status:new B.e("",[B.u.required])})}getFormData(){return{Comments:this.InvestigationFormGroup.get("Comments").value,InvestigationTrackingNo:this.parent_data.InvestigationTrackingNumber,Status:parseInt(this.InvestigationFormGroup.get("Status").value)}}onSubmit(){this.processing=!0,console.log("Comments:",this.getFormData()),this.httpSub=this.http.post(this.endpoints.updateInvestigationStatus,this.getFormData()).pipe(Object(Q.a)(this.service.handleError)).subscribe(t=>{this.dialogRef=this.dialog.open(J.a,{panelClass:["successful-message-dialog","dialogs"],disableClose:!0,data:{title:"Update Investigation Status",message:"More information required successfully",status:200===t.code}}),this.dialogRef.afterClosed().subscribe(()=>{this.allDialogRef.closeAll(),this.route.navigate(["/investigations/find"])}),this.processing=!1},t=>{this.processing=!1,t.error.message?this.dialogRef=this.dialog.open(J.a,{panelClass:["successful-message-dialog","dialogs"],disableClose:!0,data:{title:t.error.message.title?t.error.message.title:"Operation Failed",message:t.error.message.body?t.error.message.body:h.a.technicalErrorResponse,status:!1}}):this.service.determineErrorResponse(t)})}}return t.\u0275fac=function(e){return new(e||t)(o.Ob(B.d),o.Ob(K.a),o.Ob(v.c),o.Ob(W.a),o.Ob(U.b),o.Ob(n.f),o.Ob(U.b),o.Ob(U.a))},t.\u0275cmp=o.Ib({type:t,selectors:[["fury-gather-more-information"]],decls:17,vars:1,consts:[[3,"formGroup"],["fxLayout","column","fxLayoutGap","8px",1,"content"],["fxLayout","column","fxLayout.gt-xs","row","fxLayoutGap","8px","fxLayoutGap.gt-xs","24px"],["fxFlex","2 2 auto","appearance","fill"],["matInput","","cdkTextareaAutosize","","cdkAutosizeMinRows","6","formControlName","comments","cdkAutosizeMaxRows","10","formControlName","Comments"],["mat-raised-button","","color","primary",3,"click"]],template:function(t,e){1&t&&(o.Ub(0,"div"),o.Ub(1,"form",0),o.Ub(2,"mat-dialog-content"),o.Ub(3,"div",1),o.Ub(4,"div",2),o.Ub(5,"mat-form-field",3),o.Ub(6,"mat-label"),o.Rc(7,"What more information is needed"),o.Tb(),o.Pb(8,"textarea",4),o.Ub(9,"mat-hint"),o.Rc(10,"Request more Information"),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Pb(11,"br"),o.Ub(12,"div"),o.Ub(13,"button",5),o.cc("click",function(){return e.onSubmit()}),o.Ub(14,"span"),o.Rc(15,"Submit"),o.Tb(),o.Tb(),o.Rc(16,"\xa0 "),o.Tb(),o.Tb(),o.Tb()),2&t&&(o.Cb(1),o.nc("formGroup",e.InvestigationFormGroup))},directives:[B.v,B.o,B.h,U.e,tt.d,tt.e,et.d,tt.b,et.h,it.b,at.b,B.c,B.n,B.g,et.g,w.a],styles:[""]}),t})();var Ut=i("2ChS"),It=i("/t3+"),Rt=i("4FRi"),xt=i("zkoq");const yt=["autosize"];function kt(t,e){if(1&t){const t=o.Vb();o.Ub(0,"button",11),o.cc("click",function(){return o.Ec(t),o.gc().markAsResolved()}),o.Ub(1,"span"),o.Rc(2,"Close file"),o.Tb(),o.Tb()}}const Pt=function(){return{"margin-left":"10px"}};function wt(t,e){if(1&t){const t=o.Vb();o.Ub(0,"button",8),o.cc("click",function(){return o.Ec(t),o.gc().forwardInvestigation()}),o.Ub(1,"span"),o.Rc(2,"Forward To ODPP"),o.Tb(),o.Tb()}2&t&&o.nc("ngStyle",o.qc(1,Pt))}function Ot(t,e){if(1&t&&(o.Ub(0,"div"),o.Ub(1,"p"),o.Rc(2),o.Tb(),o.Pb(3,"br"),o.Ub(4,"span"),o.Rc(5),o.Tb(),o.Tb()),2&t){const t=e.$implicit;o.Cb(2),o.Sc(t.InvestigationNotes),o.Cb(3),o.Uc("",t.FirstName," ",t.LastName,"")}}function Dt(t,e){if(1&t&&(o.Ub(0,"span"),o.Rc(1),o.Tb()),2&t){const t=o.gc(3);o.Cb(1),o.Tc(" - ",t.document.Size," Mbs")}}function Nt(t,e){if(1&t&&(o.Ub(0,"span"),o.Rc(1),o.Pc(2,Dt,2,1,"span",10),o.Tb()),2&t){const t=o.gc(2);o.Cb(1),o.Tc("Document: ",t.document.Name," "),o.Cb(1),o.nc("ngIf",t.document&&t.document.Size)}}function St(t,e){1&t&&(o.Ub(0,"p",36),o.Rc(1,"No document found. Please attach"),o.Tb())}const Ft=function(){return{width:"100px",height:"100px"}};function At(t,e){if(1&t){const t=o.Vb();o.Ub(0,"div",12),o.Ub(1,"fury-card",13),o.Ub(2,"fury-card-header"),o.Ub(3,"fury-card-header-heading"),o.Rc(4,"Investigation Information"),o.Tb(),o.Tb(),o.Ub(5,"fury-card-content",14),o.Ub(6,"form",15),o.Ub(7,"fieldset"),o.Ub(8,"legend"),o.Rc(9,"Data Subject Details"),o.Tb(),o.Ub(10,"div",16),o.Ub(11,"mat-form-field",17),o.Ub(12,"mat-label"),o.Rc(13,"Data subject name"),o.Tb(),o.Pb(14,"input",18),o.Tb(),o.Ub(15,"mat-form-field",17),o.Ub(16,"mat-label"),o.Rc(17,"Data Subject Email"),o.Tb(),o.Pb(18,"input",19),o.Tb(),o.Ub(19,"mat-form-field",17),o.Ub(20,"mat-label"),o.Rc(21,"Data Subject Phone"),o.Tb(),o.Pb(22,"input",20),o.Tb(),o.Tb(),o.Tb(),o.Ub(23,"fieldset"),o.Ub(24,"legend"),o.Rc(25,"Organisation"),o.Tb(),o.Ub(26,"mat-form-field",17),o.Ub(27,"mat-label"),o.Rc(28,"Organisation under investigation"),o.Tb(),o.Pb(29,"input",21),o.Tb(),o.Tb(),o.Ub(30,"fieldset"),o.Ub(31,"legend"),o.Rc(32,"Organisation Contact Person Details"),o.Tb(),o.Ub(33,"div",16),o.Ub(34,"mat-form-field",17),o.Ub(35,"mat-label"),o.Rc(36,"Contact First Name"),o.Tb(),o.Pb(37,"input",22),o.Tb(),o.Ub(38,"mat-form-field",17),o.Ub(39,"mat-label"),o.Rc(40,"Contact Last Name"),o.Tb(),o.Pb(41,"input",23),o.Tb(),o.Ub(42,"mat-form-field",17),o.Ub(43,"mat-label"),o.Rc(44,"Contact Email"),o.Tb(),o.Pb(45,"input",24),o.Tb(),o.Tb(),o.Tb(),o.Ub(46,"fieldset"),o.Ub(47,"legend"),o.Rc(48,"General Investigation Info"),o.Tb(),o.Ub(49,"div",25),o.Ub(50,"fieldset"),o.Ub(51,"legend"),o.Rc(52,"Initial Investigation Notes"),o.Tb(),o.Ub(53,"mat-label"),o.Rc(54,"PDPO Director's investigation notes"),o.Tb(),o.Ub(55,"mat-grid-list",26),o.Ub(56,"mat-grid-tile"),o.Pb(57,"textarea",27,28),o.Tb(),o.Tb(),o.Tb(),o.Ub(59,"div",16),o.Ub(60,"mat-form-field",29),o.Ub(61,"mat-label"),o.Rc(62,"Police Investigation Notes"),o.Tb(),o.Pc(63,Ot,6,3,"div",30),o.Pb(64,"textarea",31,28),o.Tb(),o.Tb(),o.Ub(66,"div",16),o.Ub(67,"mat-form-field",29),o.Ub(68,"mat-label"),o.Rc(69,"DPP Investigation Notes"),o.Tb(),o.Pb(70,"textarea",32,28),o.Tb(),o.Tb(),o.Ub(72,"fieldset"),o.Ub(73,"legend"),o.Rc(74,"Evidence Of Investigation"),o.Tb(),o.Ub(75,"div",33),o.cc("click",function(){return o.Ec(t),o.gc().onReadDocument()}),o.Pb(76,"img",34),o.Pc(77,Nt,3,2,"span",10),o.Tb(),o.Pc(78,St,2,0,"p",35),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Tb()}if(2&t){const t=o.gc();o.nc("fxLayoutGap",t.gap),o.Cb(1),o.nc("fxFlex.gt-sm",t.col2)("@fadeInUp",void 0),o.Cb(5),o.nc("formGroup",t.investigationForm),o.Cb(57),o.nc("ngForOf",t.InvestigationNotes),o.Cb(13),o.nc("ngStyle",o.qc(8,Ft)),o.Cb(1),o.nc("ngIf",t.document&&t.document.Name),o.Cb(1),o.nc("ngIf",t.document&&!t.document.Base64)}}function Mt(t,e){if(1&t&&(o.Ub(0,"div"),o.Ub(1,"p"),o.Rc(2),o.Tb(),o.Pb(3,"br"),o.Ub(4,"span"),o.Rc(5),o.Tb(),o.Tb()),2&t){const t=e.$implicit;o.Cb(2),o.Sc(t.InvestigationNotes),o.Cb(3),o.Uc("",t.FirstName," ",t.LastName,"")}}function Et(t,e){if(1&t&&(o.Ub(0,"span"),o.Rc(1),o.Tb()),2&t){const t=o.gc(3);o.Cb(1),o.Tc(" - ",t.document.Size," Mbs")}}function zt(t,e){if(1&t&&(o.Ub(0,"span"),o.Rc(1),o.Pc(2,Et,2,1,"span",10),o.Tb()),2&t){const t=o.gc(2);o.Cb(1),o.Tc("Document: ",t.document.Name," "),o.Cb(1),o.nc("ngIf",t.document&&t.document.Size)}}function Lt(t,e){1&t&&(o.Ub(0,"p",36),o.Rc(1,"No document found. Please attach"),o.Tb())}const jt=function(){return{"margin-right":"20px"}};function qt(t,e){if(1&t){const t=o.Vb();o.Ub(0,"div"),o.Ub(1,"fury-card",13),o.Ub(2,"fury-card-header"),o.Ub(3,"fury-card-header-heading"),o.Rc(4,"Investigation Information"),o.Tb(),o.Tb(),o.Ub(5,"fury-card-content",14),o.Ub(6,"form",15),o.Ub(7,"fieldset"),o.Ub(8,"legend"),o.Rc(9,"Organisation"),o.Tb(),o.Ub(10,"div",16),o.Ub(11,"mat-form-field",37),o.Ub(12,"mat-label"),o.Rc(13,"Name of Organisation"),o.Ub(14,"span",38),o.Rc(15,"required"),o.Tb(),o.Tb(),o.Pb(16,"textarea",39,28),o.Ub(18,"mat-hint"),o.Rc(19,"Organisation that is affected"),o.Tb(),o.Tb(),o.Ub(20,"mat-form-field",37),o.Ub(21,"mat-label"),o.Rc(22,"Registration Number"),o.Tb(),o.Pb(23,"textarea",40,28),o.Ub(25,"mat-hint"),o.Rc(26,"The number assigned after registration"),o.Tb(),o.Tb(),o.Ub(27,"mat-form-field",37),o.Ub(28,"mat-label"),o.Rc(29,"Email Address of Organisation"),o.Ub(30,"span",38),o.Rc(31,"required"),o.Tb(),o.Tb(),o.Pb(32,"textarea",41,28),o.Ub(34,"mat-hint"),o.Rc(35,"Contact Email of Organisation"),o.Tb(),o.Tb(),o.Ub(36,"mat-form-field",42),o.Ub(37,"mat-label"),o.Rc(38,"Telephone Number of Organisation"),o.Ub(39,"span",38),o.Rc(40,"required"),o.Tb(),o.Tb(),o.Pb(41,"textarea",43,28),o.Ub(43,"mat-hint"),o.Rc(44,"Contact Number of Organisation"),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Ub(45,"fieldset"),o.Ub(46,"legend"),o.Rc(47,"Causes of Breach"),o.Tb(),o.Ub(48,"mat-form-field",44),o.Ub(49,"mat-label"),o.Rc(50,"Likely Causes of the breach"),o.Tb(),o.Ub(51,"textarea",45,28),o.Rc(53,"                                "),o.Tb(),o.Ub(54,"mat-hint"),o.Rc(55,"Please specify if any financial or sensitive personal data that has been affected "),o.Tb(),o.Tb(),o.Ub(56,"mat-form-field",44),o.Ub(57,"mat-label"),o.Rc(58,"Number of data Subjects"),o.Tb(),o.Pb(59,"textarea",46,28),o.Ub(61,"mat-hint"),o.Rc(62,"Subjects affected by breach"),o.Tb(),o.Tb(),o.Ub(63,"mat-form-field",44),o.Ub(64,"mat-label"),o.Rc(65,"Total Number of Records held"),o.Tb(),o.Pb(66,"textarea",47,28),o.Ub(68,"mat-hint"),o.Rc(69,"Breached records as a percentage"),o.Tb(),o.Tb(),o.Tb(),o.Ub(70,"fieldset"),o.Ub(71,"legend"),o.Rc(72,"Recovery Details"),o.Tb(),o.Ub(73,"div",16),o.Ub(74,"mat-form-field",44),o.Ub(75,"mat-label"),o.Rc(76,"Data recovery details"),o.Tb(),o.Pb(77,"textarea",48,28),o.Ub(79,"mat-hint"),o.Rc(80,"If so, please provide details of how and when this occurred. "),o.Tb(),o.Tb(),o.Ub(81,"mat-form-field",44),o.Ub(82,"mat-label"),o.Rc(83,"Prevention Steps"),o.Tb(),o.Pb(84,"textarea",49,28),o.Ub(86,"mat-hint"),o.Rc(87,"What steps have been taken to prevent a recurrence of this incident ? "),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Ub(88,"fieldset"),o.Ub(89,"legend"),o.Rc(90,"General Investigation Info"),o.Tb(),o.Ub(91,"div",25),o.Ub(92,"fieldset"),o.Ub(93,"legend"),o.Rc(94,"Initial Investigation Notes"),o.Tb(),o.Ub(95,"mat-label"),o.Rc(96,"PDPO Director's investigation notes"),o.Tb(),o.Ub(97,"mat-grid-list",26),o.Ub(98,"mat-grid-tile"),o.Pb(99,"textarea",50,28),o.Tb(),o.Tb(),o.Tb(),o.Ub(101,"div",16),o.Ub(102,"mat-form-field",29),o.Ub(103,"mat-label"),o.Rc(104,"Police Investigation Notes"),o.Tb(),o.Pc(105,Mt,6,3,"div",30),o.Pb(106,"textarea",31,28),o.Tb(),o.Tb(),o.Ub(108,"div",16),o.Ub(109,"mat-form-field",29),o.Ub(110,"mat-label"),o.Rc(111,"DPP Investigation Notes"),o.Tb(),o.Pb(112,"textarea",32,28),o.Tb(),o.Tb(),o.Ub(114,"fieldset"),o.Ub(115,"legend"),o.Rc(116,"Evidence Of Investigation"),o.Tb(),o.Ub(117,"div",33),o.cc("click",function(){return o.Ec(t),o.gc().onReadDocument()}),o.Pb(118,"img",34),o.Pc(119,zt,3,2,"span",10),o.Tb(),o.Pc(120,Lt,2,0,"p",35),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Tb()}if(2&t){const t=o.gc();o.Cb(1),o.nc("fxFlex.gt-sm",t.col2)("@fadeInUp",void 0),o.Cb(5),o.nc("formGroup",t.investigationForm),o.Cb(5),o.nc("ngStyle",o.qc(10,jt)),o.Cb(9),o.nc("ngStyle",o.qc(11,jt)),o.Cb(7),o.nc("ngStyle",o.qc(12,jt)),o.Cb(78),o.nc("ngForOf",t.InvestigationNotes),o.Cb(13),o.nc("ngStyle",o.qc(13,Ft)),o.Cb(1),o.nc("ngIf",t.document&&t.document.Name),o.Cb(1),o.nc("ngIf",t.document&&!t.document.Base64)}}const Gt=function(){return["Investigations"]},_t=function(){return{"margin-left":"300px"}},Vt=[{path:"find",component:V,canActivate:[$.a],data:{roles:["view.investigation","find.investigation"],action:"FIND"}},{path:"investigations-edit",component:(()=>{class t extends X.a{constructor(t,e,i,a,n,r,c,l,b,m,g,d,p,h,f,v,T,C){super(h,f,v,C),this.formBuilder=t,this.activateRoute=e,this.route=i,this.dialog=a,this.bottomsheet=n,this.endpoints=r,this.http=c,this.service=l,this.allDialogRef=b,this.auth=m,this.utilService=g,this._auth=d,this.snackBar=p,this.authService=h,this._workflowService=f,this.registrationService=v,this.investigationService=T,this.complaintService=C,this.subject$=new u.a(1),this.data$=this.subject$.asObservable(),this.personalDataEvent=new o.o,this.PersonalDataAffected=new o.o,this.investigationDetails=new o.o,this.$processingEvent=new o.o,this.$errorsEvent=new o.o,this.$resultInvestigationsEvent=new o.o,this.subscriptions=[],this.workflowID="1",this.ActionTakenCheckboxValue=0,this.disableResolve=!0,this.disableForward=!1,this.processing=!1,this.isDirector=!1,this.isPolice=!1,this.isODPP=!1,this.isTechnical=!1,this.isLegal=!1,this.InvestigationNotes=new s.c,this.application=new s.b,this.DataSubjectsCategories=[],this.investigationReasons=[],this.list=[],this.permittedActions=[],this.dataCategories=[],this.$dataCategories=[],this.$subCategories=[],this.dataSubcategories=[],this.dataCategory=new B.e,this.dataSubCategory=new B.e,this.buttonIcon="add_circle_outline",this.buttonLabel="Add",this.isEditingPersonalData=!1,this.tableEditable=!0,this.ResolveInvestigation=!1,this.CanForwardToDPP=!1,this.personalDataIndex=0,this.personalNumber=1,this._gap=16,this.gap=this._gap+"px",this.col2=`1 1 calc(50% - ${this._gap/2}px)`,this.col3=`1 1 calc(33.3333% - ${this._gap/1.5}px)`,this.InvestigationTrackingNumber=this.route.getCurrentNavigation().extras.state.InvestigationTrackingNumber,console.log(this.InvestigationTrackingNumber),this.InvestigationID=this.route.getCurrentNavigation().extras.state.InvestigationID,console.log(this.InvestigationID),this.accesses=h.getKeycloakInstance().resourceAccess["dps-frontend"].roles,console.log(this.accesses),console.log(d.getUser().id),this.accesses.includes("resolve.investigation")&&(this.ResolveInvestigation=!0),this.accesses.includes("forward.investigation")&&(this.CanForwardToDPP=!0)}ngOnInit(){this.initForm(),this.getInvestigation(),this.subscriptions.$resultComplaintsEvent=this.$resultInvestigationsEvent.subscribe(t=>{t&&(this.httpSub=this.http.get(this.endpoints.getInvestigationNotes+"?InvestigationTrackingNo="+this.InvestigationTrackingNumber).pipe(Object(Q.a)(this.service.handleError)).subscribe(e=>{console.log(e),this.application=t,this.InvestigationNotes=e,console.log(this.InvestigationNotes),console.log(this.application),this.mapFields(),this.dialogRef.afterClosed().subscribe(()=>{this.allDialogRef.closeAll(),this.route.navigate(["/investigations/find"])}),this.processing=!1},t=>{this.processing=!1,t.error.message||this.service.determineErrorResponse(t)}))})}initForm(){this.investigationForm=this.formBuilder.group({reasonForTheInvestigation:["",B.u.compose([B.u.required])],InvestigationDetails:["",B.u.compose([B.u.required])],dataSubjectName:["",B.u.compose([B.u.required])],dataSubjectPhone:["",B.u.compose([B.u.required])],dataSubjectEmail:["",B.u.compose([B.u.required])],ContactFirstName:["",B.u.compose([B.u.required])],ContactLastName:["",B.u.compose([B.u.required])],ContactEmailAddress:["",B.u.compose([B.u.required])],Organisation:["",B.u.compose([B.u.required])],lastModificationDate:[],OrganisationName:["",B.u.compose([B.u.required])],RegNo:["",B.u.compose([B.u.required])],OrganisationEmail:["",B.u.compose([B.u.required])],OrganisationNumber:["",B.u.compose([B.u.required])],BreachCauses:["",B.u.compose([B.u.required])],DataSubjects:["",B.u.compose([B.u.required])],measures:["",B.u.compose([B.u.required])],detailsOfRecovery:["",B.u.compose([B.u.required])],preventionSteps:["",B.u.compose([B.u.required])],investigationDetails:["",B.u.compose([B.u.required])],PoliceNotes:["",B.u.compose([B.u.required])],DPPNotes:["",B.u.compose([B.u.required])]})}getFormData(){return{SubjectName:this.investigationForm.get("dataSubjectName").value?this.investigationForm.get("dataSubjectName").value:"",SubjectEmail:this.investigationForm.get("dataSubjectEmail").value?this.investigationForm.get("dataSubjectEmail").value:"",SubjectPhone:this.investigationForm.get("dataSubjectPhone").value?this.investigationForm.get("dataSubjectPhone").value:"",SubjectOrganisation:this.investigationForm.get("InvestigationCategory").value?this.investigationForm.get("InvestigationCategory").value:"",InvestigationInformation:this.investigationForm.get("investigationDetails").value?this.investigationForm.get("investigationDetails").value:""}}get getSamplJson(){return Object(H.a)(s.a)}getInvestigation(){this.investigationService.getInvestigation(this.InvestigationTrackingNumber,this.$processingEvent,this.$resultInvestigationsEvent,this.$errorsEvent)}markAsResolved(){this.dialog.open(lt,{width:"1391px",height:"595px",data:{InvestigationTrackingNumber:this.InvestigationTrackingNumber,Status:4,ClosingRemarksOwner:this._auth.getUser().id}})}mapFields(){this.investigationForm.get("dataSubjectName").setValue(this.application[0].FirstName+" "+this.application[0].LastName),this.investigationForm.get("dataSubjectPhone").setValue(this.application[0].PhoneNumber),this.investigationForm.get("dataSubjectEmail").setValue(this.application[0].EmailAddress),this.investigationForm.get("Organisation").setValue(this.application[0].Organisation),this.investigationForm.get("ContactFirstName").setValue(this.application[0].ContactPersonFirstName),this.investigationForm.get("ContactLastName").setValue(this.application[0].ContactPersonLastName),this.investigationForm.get("ContactEmailAddress").setValue(this.application[0].ContactPersonEmailAddress),this.investigationForm.get("InvestigationDetails").setValue(this.application[0].InvestigationNotes),this.investigationForm.get("OrganisationName").setValue(this.application[0].OrganisationName),this.investigationForm.get("RegNo").setValue(this.application[0].RegNo),this.investigationForm.get("OrganisationEmail").setValue(this.application[0].OrganisationEmail),this.investigationForm.get("OrganisationNumber").setValue(this.application[0].OrganisationNumber),this.investigationForm.get("BreachCauses").setValue(this.application[0].BreachCauses),this.investigationForm.get("DataSubjects").setValue(this.application[0].DataSubjects),this.investigationForm.get("measures").setValue(this.application[0].measures),this.investigationForm.get("detailsOfRecovery").setValue(this.application[0].detailsOfRecovery),this.investigationForm.get("preventionSteps").setValue(this.application[0].preventionSteps),this.investigationForm.get("investigationDetails").setValue(this.application[0].investigationDetails),this.investigationForm.get("PoliceNotes").setValue(this.application[0].PoliceNotes),this.investigationForm.get("DPPNotes").setValue(this.application[0].DPPNotes)}makeNotes(){let t;t=1==this.ResolveInvestigation?3:2,this.dialog.open(ht,{width:"1391px",height:"595px",data:{InvestigationTrackingNumber:this.InvestigationTrackingNumber,Status:t,EvidenceOwner:this._auth.getUser().id}})}onReadDocument(){this.bottomsheetRef=this.bottomsheet.open(Y.a,{disableClose:!0,panelClass:["view-pdf-document-bottomsheet","bottomsheets"],data:{url:this.document.Base64,title:this.document.Name}})}viewApplicationTimeLine(){this.dialog.open(C.a,{width:"941px",height:"595px",data:this.workflowTimeLine})}forwardInvestigation(){let t;t=1==this.ResolveInvestigation?4:3,this.dialog.open(vt,{width:"500px",height:"200px",data:{InvestigationTrackingNumber:this.InvestigationTrackingNumber,Status:t,User:this._auth.getUser().id}})}moreInformation(){this.dialog.open(Ct,{width:"1391px",height:"595px",data:{InvestigationTrackingNumber:this.InvestigationTrackingNumber}}).afterClosed().subscribe(t=>{})}}return t.\u0275fac=function(e){return new(e||t)(o.Ob(B.d),o.Ob(n.a),o.Ob(n.f),o.Ob(U.b),o.Ob(Ut.b),o.Ob(K.a),o.Ob(v.c),o.Ob(W.a),o.Ob(U.b),o.Ob(f.c),o.Ob(bt.a),o.Ob(Tt.a),o.Ob(ut.a),o.Ob(f.c),o.Ob(m.a),o.Ob(g.a),o.Ob(T),o.Ob(mt.a))},t.\u0275cmp=o.Ib({type:t,selectors:[["fury-investigations-edit"]],viewQuery:function(t,e){if(1&t&&o.Vc(yt,!0),2&t){let t;o.zc(t=o.dc())&&(e.autosize=t.first)}},inputs:{personalDataList:"personalDataList",isViewOnly:"isViewOnly",personalDataEvent:"personalDataEvent"},outputs:{PersonalDataAffected:"PersonalDataAffected",investigationDetails:"investigationDetails"},features:[o.zb],decls:23,vars:14,consts:[["mode","card"],["current","Manage",3,"crumbs"],["fxLayout","column",3,"fxLayoutGap"],[1,"actions-button-padding"],[1,"example-spacer"],["mat-raised-button","","matTooltip","View Timeline","class","actions-button-padding","color","primary",3,"click",4,"ngIf"],["mat-raised-button","","class","actions-button-padding","color","primary",3,"ngStyle","click",4,"ngIf"],["mat-raised-button","","matTooltip","View Timeline","color","primary",1,"actions-button-padding",3,"ngStyle","click"],["mat-raised-button","","color","primary",1,"actions-button-padding",3,"ngStyle","click"],["fxFlex","noshrink","fxLayout","column","fxLayout.gt-sm","row","fxLayoutAlign.gt-sm","start stretch",3,"fxLayoutGap",4,"ngIf"],[4,"ngIf"],["mat-raised-button","","matTooltip","View Timeline","color","primary",1,"actions-button-padding",3,"click"],["fxFlex","noshrink","fxLayout","column","fxLayout.gt-sm","row","fxLayoutAlign.gt-sm","start stretch",3,"fxLayoutGap"],["fxFlex","grow",1,"basic-forms","route-animations-elements",3,"fxFlex.gt-sm"],["fxLayout","column",1,"form-padding"],[3,"formGroup"],["fxLayout","column","fxLayout.gt-xs","row","fxLayoutGap","8px","fxLayoutGap.gt-xs","24px"],["fxFlex","2 1 auto"],["formControlName","dataSubjectName","matInput",""],["formControlName","dataSubjectEmail","matInput",""],["formControlName","dataSubjectPhone","matInput",""],["formControlName","Organisation","matInput",""],["formControlName","ContactFirstName","matInput",""],["formControlName","ContactLastName","matInput",""],["formControlName","ContactEmailAddress","matInput",""],["fxLayout","column","fxLayoutGap","8px",1,"content"],["cols","4","rowHeight","4rem"],["matInput","","cdkTextareaAutosize","","cdkAutosizeMinRows","1","formControlName","InvestigationDetails","cdkAutosizeMaxRows","5"],["autosize","cdkTextareaAutosize"],["fxFlex","2 1 auto","appearance","fill"],[4,"ngFor","ngForOf"],["matInput","","cdkTextareaAutosize","","cdkAutosizeMinRows","1","formControlName","PoliceNotes","cdkAutosizeMaxRows","5"],["matInput","","cdkTextareaAutosize","","cdkAutosizeMinRows","1","formControlName","DPPNotes","cdkAutosizeMaxRows","5"],["matTooltip","Open Document",1,"uploaded-document",3,"click"],["src","./assets/img/pdf.png","alt","",3,"ngStyle"],["class","no-document-found",4,"ngIf"],[1,"no-document-found"],["fxFlex","2 2 auto",3,"ngStyle"],[1,"required-field"],["matInput","","cdkTextareaAutosize","","cdkAutosizeMinRows","1","formControlName","OrganisationName","cdkAutosizeMaxRows","5"],["matInput","","cdkTextareaAutosize","","cdkAutosizeMinRows","1","formControlName","RegNo","cdkAutosizeMaxRows","5"],["matInput","","cdkTextareaAutosize","","cdkAutosizeMinRows","1","formControlName","OrganisationEmail","cdkAutosizeMaxRows","5"],["fxFlex","2 2 auto"],["matInput","","cdkTextareaAutosize","","cdkAutosizeMinRows","1","formControlName","OrganisationNumber","cdkAutosizeMaxRows","5"],["fxFlex","2 2 auto","appearance","fill"],["matInput","","cdkTextareaAutosize","","cdkAutosizeMinRows","1","formControlName","BreachCauses","cdkAutosizeMaxRows","5"],["matInput","","cdkTextareaAutosize","","cdkAutosizeMinRows","1","formControlName","DataSubjects","cdkAutosizeMaxRows","5"],["matInput","","cdkTextareaAutosize","","cdkAutosizeMinRows","1","formControlName","measures","cdkAutosizeMaxRows","5"],["matInput","","cdkTextareaAutosize","","cdkAutosizeMinRows","1","formControlName","detailsOfRecovery","cdkAutosizeMaxRows","5"],["matInput","","cdkTextareaAutosize","","cdkAutosizeMinRows","1","formControlName","preventionSteps","cdkAutosizeMaxRows","5"],["matInput","","cdkTextareaAutosize","","cdkAutosizeMinRows","1","formControlName","investigationDetails","cdkAutosizeMaxRows","5"]],template:function(t,e){1&t&&(o.Ub(0,"fury-page-layout",0),o.Ub(1,"fury-page-layout-header"),o.Pb(2,"fury-breadcrumbs",1),o.Tb(),o.Ub(3,"fury-page-layout-content",2),o.Ub(4,"div",3),o.Ub(5,"mat-toolbar"),o.Ub(6,"mat-toolbar-row"),o.Pb(7,"span",4),o.Pc(8,kt,3,0,"button",5),o.Pc(9,wt,3,2,"button",6),o.Ub(10,"button",7),o.cc("click",function(){return e.moreInformation()}),o.Ub(11,"span"),o.Rc(12,"Request for further investigation"),o.Tb(),o.Tb(),o.Ub(13,"button",8),o.cc("click",function(){return e.makeNotes()}),o.Ub(14,"span"),o.Rc(15,"Make Notes"),o.Tb(),o.Tb(),o.Ub(16,"button",7),o.cc("click",function(){return e.viewApplicationTimeLine()}),o.Ub(17,"mat-icon"),o.Rc(18,"view_timeline"),o.Tb(),o.Ub(19,"span"),o.Rc(20,"Application Timeline"),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Tb(),o.Pc(21,At,79,9,"div",9),o.Pc(22,qt,121,14,"div",10),o.Tb(),o.Tb()),2&t&&(o.Cb(2),o.nc("@fadeInRight",void 0)("crumbs",o.qc(10,Gt)),o.Cb(1),o.nc("fxLayoutGap",e.gap),o.Cb(5),o.nc("ngIf",1==e.ResolveInvestigation),o.Cb(1),o.nc("ngIf",1==e.CanForwardToDPP),o.Cb(1),o.nc("ngStyle",o.qc(11,Pt)),o.Cb(3),o.nc("ngStyle",o.qc(12,_t)),o.Cb(3),o.nc("ngStyle",o.qc(13,Pt)),o.Cb(5),o.nc("ngIf",null!==e.application[0].InvestigationComplaintID),o.Cb(1),o.nc("ngIf",null!==e.application[0].InvestigationDataBreachID))},directives:[I.a,R.a,x.a,y.a,tt.d,tt.e,It.a,It.c,a.o,w.a,ot.a,a.p,nt.c,D.a,tt.b,tt.c,Rt.a,Rt.d,Rt.g,Rt.c,B.v,B.o,B.h,et.d,et.h,B.c,it.b,B.n,B.g,xt.a,xt.c,at.b,a.n,et.g],styles:[""]}),t})(),canActivate:[$.a],data:{roles:["view.investigation"],action:"VIEW"}}];let $t=(()=>{class t{}return t.\u0275mod=o.Mb({type:t}),t.\u0275inj=o.Lb({factory:function(e){return new(e||t)},imports:[[n.j.forChild(Vt)],n.j]}),t})();var Bt=i("q8Jb"),Xt=i("WCGO"),Ht=i("0jmt"),Yt=i("6BeY"),Kt=i("KthW"),Qt=i("AyUp"),Wt=i("QMK6"),Jt=i("VE2z"),Zt=i("hVPj"),te=i("VCcF");let ee=(()=>{class t{}return t.\u0275mod=o.Mb({type:t}),t.\u0275inj=o.Lb({factory:function(e){return new(e||t)},imports:[[a.c,$t,Kt.a,Xt.a,Qt.a,B.s,te.a,Ht.a,Zt.a,Wt.a,Jt.a,Yt.a,Bt.a]]}),t})()},QMK6:function(t,e,i){"use strict";i.d(e,"a",function(){return n});var a=i("fXoL");let n=(()=>{class t{}return t.\u0275mod=a.Mb({type:t}),t.\u0275inj=a.Lb({factory:function(e){return new(e||t)},imports:[[]]}),t})()},YStQ:function(t,e,i){"use strict";i.d(e,"a",function(){return u});var a=i("0IaG"),n=i("fXoL"),o=i("ofXK"),s=i("bTqV"),r=i("NFeN"),c=i("bv9b");function l(t,e){1&t&&n.Pb(0,"mat-progress-bar",5)}const b=function(t,e){return{"status-true":t,"status-false":e}};let u=(()=>{class t{constructor(t,e){this.data=t,this.dialogRef=e,this.processing=!1}ngOnInit(){}onCloseDialog(){this.dialogRef.close()}}return t.\u0275fac=function(e){return new(e||t)(n.Ob(a.a),n.Ob(a.g))},t.\u0275cmp=n.Ib({type:t,selectors:[["app-successful-message-dialog"]],decls:10,vars:7,consts:[[3,"ngClass"],[1,"mat-progress-bar-container"],["mode","indeterminate",4,"ngIf"],[3,"innerHTML"],["mat-button","",3,"click"],["mode","indeterminate"]],template:function(t,e){1&t&&(n.Ub(0,"main",0),n.Ub(1,"div",1),n.Pc(2,l,1,0,"mat-progress-bar",2),n.Tb(),n.Ub(3,"header"),n.Pb(4,"h1",3),n.Ub(5,"button",4),n.cc("click",function(){return e.onCloseDialog()}),n.Ub(6,"mat-icon"),n.Rc(7,"clear"),n.Tb(),n.Tb(),n.Tb(),n.Ub(8,"section"),n.Pb(9,"p",3),n.Tb(),n.Tb()),2&t&&(n.nc("ngClass",n.sc(4,b,!0===e.data.status,!1===e.data.status)),n.Cb(2),n.nc("ngIf",e.processing),n.Cb(2),n.nc("innerHTML",e.data.title,n.Fc),n.Cb(5),n.nc("innerHTML",e.data.message,n.Fc))},directives:[o.m,o.o,s.a,r.a,c.a],styles:["main[_ngcontent-%COMP%]{position:relative;flex-direction:column}main[_ngcontent-%COMP%], main[_ngcontent-%COMP%]   header[_ngcontent-%COMP%]{display:flex;justify-content:center}main[_ngcontent-%COMP%]   header[_ngcontent-%COMP%]{align-items:center;height:56px;margin-bottom:-10px;margin-top:10px}main[_ngcontent-%COMP%]   header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:20px;margin:0;font-weight:300}main[_ngcontent-%COMP%]   header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{position:absolute;top:0;right:0;border-radius:0;width:44px;height:44px;min-width:0;display:flex;align-items:center;justify-content:center;padding:0}main[_ngcontent-%COMP%]   section[_ngcontent-%COMP%]{padding:10px 20px 20px}main[_ngcontent-%COMP%]   section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:justify;font-size:13px;font-weight:500;color:#373636}main.status-true[_ngcontent-%COMP%]{border:3px solid #6cbd45}main.status-true[_ngcontent-%COMP%]   header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#6cbd45}main.status-false[_ngcontent-%COMP%]{border:3px solid #f44336}main.status-false[_ngcontent-%COMP%]   header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#f44336}"]}),t})()}}]);